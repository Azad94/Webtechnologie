part of pacmanViewLib;

/**
 * the paths as const for the different graphics
 */
/**
 * enviornment resources
 */
const String _wall =
    "background-image:url(../web/resc/enviornment/wall32.png);";
const String _door =
    "background-image:url(../web/resc/enviornment/door32.png);";
const String _wall16 =
    "background-image:url(../web/resc/16px/enviornment/wall16.png);";
const String _door16 =
    "background-image:url(../web/resc/16px/enviornment/door16.png);";
/**
 * ghost normal state resources
 */
/**
 * Blinky
 */
const String _blinky_r =
    "background-image:url(../web/resc/ghosts/blinky/blinky_r32.png);";
const String _blinky_l =
    "background-image:url(../web/resc/ghosts/blinky/blinky_l32.png);";
const String _blinky_u =
    "background-image:url(../web/resc/ghosts/blinky/blinky_t32.png);";
const String _blinky_d =
    "background-image:url(../web/resc/ghosts/blinky/blinky_d32.png);";
const String _blinky_r16 =
    "background-image:url(../web/resc/16px/ghosts/blinky/blinky_r16.png);";
const String _blinky_l16 =
    "background-image:url(../web/resc/16px/ghosts/blinky/blinky_l16.png);";
const String _blinky_u16 =
    "background-image:url(../web/resc/16px/ghosts/blinky/blinky_t16.png);";
const String _blinky_d16 =
    "background-image:url(../web/resc/16px/ghosts/blinky/blinky_d16.png);";
/**
 * Pinky
 */
const String _pinky_r =
    "background-image:url(../web/resc/ghosts/pinky/pinky_r32.png);";
const String _pinky_l =
    "background-image:url(../web/resc/ghosts/pinky/pinky_l32.png);";
const String _pinky_u =
    "background-image:url(../web/resc/ghosts/pinky/pinky_t32.png);";
const String _pinky_d =
    "background-image:url(../web/resc/ghosts/pinky/pinky_d32.png);";
const String _pinky_r16 =
    "background-image:url(../web/resc/16px/ghosts/pinky/pinky_r16.png);";
const String _pinky_l16 =
    "background-image:url(../web/resc/16px/ghosts/pinky/pinky_l16.png);";
const String _pinky_u16 =
    "background-image:url(../web/resc/16px/ghosts/pinky/pinky_t16.png);";
const String _pinky_d16 =
    "background-image:url(../web/resc/16px/ghosts/pinky/pinky_d16.png);";
/**
 * Inky
 */
const String _inky_r =
    "background-image:url(../web/resc/ghosts/inky/inky_r32.png);";
const String _inky_l =
    "background-image:url(../web/resc/ghosts/inky/inky_l32.png);";
const String _inky_u =
    "background-image:url(../web/resc/ghosts/inky/inky_t32.png);";
const String _inky_d =
    "background-image:url(../web/resc/ghosts/inky/inky_d32.png);";
const String _inky_r16 =
    "background-image:url(../web/resc/16px/ghosts/inky/inky_r16.png);";
const String _inky_l16 =
    "background-image:url(../web/resc/16px/ghosts/inky/inky_l16.png);";
const String _inky_u16 =
    "background-image:url(../web/resc/16px/ghosts/inky/inky_t16.png);";
const String _inky_d16 =
    "background-image:url(../web/resc/16px/ghosts/inky/inky_d16.png);";
/**
 * Clyde
 */
const String _clyde_r =
    "background-image:url(../web/resc/ghosts/clyde/clyde_r32.png);";
const String _clyde_l =
    "background-image:url(../web/resc/ghosts/clyde/clyde_l32.png);";
const String _clyde_u =
    "background-image:url(../web/resc/ghosts/clyde/clyde_t32.png);";
const String _clyde_d =
    "background-image:url(../web/resc/ghosts/clyde/clyde_d32.png);";
const String _clyde_r16 =
    "background-image:url(../web/resc/16px/ghosts/clyde/clyde_r16.png);";
const String _clyde_l16 =
    "background-image:url(../web/resc/16px/ghosts/clyde/clyde_l16.png);";
const String _clyde_u16 =
    "background-image:url(../web/resc/16px/ghosts/clyde/clyde_t16.png);";
const String _clyde_d16 =
    "background-image:url(../web/resc/16px/ghosts/clyde/clyde_d16.png);";
/**
 * ghost scared state resources
 */
const String _scared_r =
    "background-image:url(../web/resc/ghosts/scared/a_scaredghost_r.gif);";
const String _scared_l =
    "background-image:url(../web/resc/ghosts/scared/a_scaredghost_l.gif);";
const String _scared_u =
    "background-image:url(../web/resc/ghosts/scared/a_scaredghost_t.gif);";
const String _scared_d =
    "background-image:url(../web/resc/ghosts/scared/a_scaredghost_d.gif);";
const String _scared_r16 =
    "background-image:url(../web/resc/16px/ghosts/scared/a_scaredghost_r16.gif);";
const String _scared_l16 =
    "background-image:url(../web/resc/16px/ghosts/scared/a_scaredghost_l16.gif);";
const String _scared_u16 =
    "background-image:url(../web/resc/16px/ghosts/scared/a_scaredghost_t16.gif);";
const String _scared_d16 =
    "background-image:url(../web/resc/16px/ghosts/scared/a_scaredghost_d16.gif);";
/**
 * Pacman normal state resources
 */
const String _pacman_r =
    "background-image:url(../web/resc/pacman/pacman_r32.gif);";
const String _pacman_l =
    "background-image:url(../web/resc/pacman/pacman_l32.gif);";
const String _pacman_u =
    "background-image:url(../web/resc/pacman/pacman_u32.gif);";
const String _pacman_d =
    "background-image:url(../web/resc/pacman/pacman_d32.gif);";
const String _pacman_r16 =
    "background-image:url(../web/resc/16px/pacman/pacman_r16.gif);";
const String _pacman_l16 =
    "background-image:url(../web/resc/16px/pacman/pacman_l16.gif);";
const String _pacman_u16 =
    "background-image:url(../web/resc/16px/pacman/pacman_u16.gif);";
const String _pacman_d16 =
    "background-image:url(../web/resc/16px/pacman/pacman_d16.gif);";

/**
 * items resources
 */
const String _pill = "background-image:url(../web/resc/items/pill32.png);";
const String _powerpill =
    "background-image:url(../web/resc/items/a_powerpill32.gif);";
const String _cherry =
    "background-image:url(../web/resc/items/a_cherry32.gif);";
const String _apple =
    "background-image:url(../web/resc/items/a_apple32.gif);";
const String _pill16 =
    "background-image:url(../web/resc/16px/items/pill16.png);";
const String _powerpill16 =
    "background-image:url(../web/resc/16px/items/a_powerpill16.gif);";
const String _cherry16 =
    "background-image:url(../web/resc/16px/items/a_cherry16.gif);";
const String _apple16 =
    "background-image:url(../web/resc/items/a_apple16.gif);";

/**
 * A [PacmanGameView] object interacts with the DOM tree
 * to reflect actual [PacmanGame] state to the user
 */
class PacmanGameView {
  PacmanGameController _con;

  //the different div-classes from the html-document
  final _error = querySelector("#error");
  final _loadingscreen = querySelector(".cssload-container");
  final _pause = querySelector("#pause");
  final _game = querySelector(".game");
  final _overlay = querySelector("#overlay");
  final _gameend = querySelector("#gameend");
  final startNext = querySelector("#startNext");
  final _highscore = querySelector("#userinput");
  //final _name = querySelector("#namescore");
  final username = querySelector("#username");
  final savename = querySelector("#save");
  final _labyrinth = querySelector("#gamefield");
  final _level = querySelector("#value1");
  final _score = querySelector("#value2");
  final _lives = querySelector("#value3");
  final _mobile = querySelector(".mobile");
  final mobileUp = querySelector("#mobileUp");
  final mobileDown = querySelector("#mobileDown");
  final mobileLeft = querySelector("#mobileLeft");
  final mobileRight = querySelector("#mobileRight");
  final mobilePause = querySelector("#mobilePause");
  final _message = querySelector(".messages");

  var _mql = window.matchMedia("screen and (max-device-width : 800px)");
  var _mqlLandscape = window.matchMedia("screen and (orientation: landscape)");

  //constructor
  PacmanGameView(_con);

  MediaQueryList get mql => _mql;


  void showErrorScreen() {
    _error.style.display = "block";
    _game.style.display = "none";
    _loadingscreen.style.display = "none";
  }
  void showPause(){
    _pause.style.display = "block";
  }
  void hidePause() {
    _pause.style.display = "none";
  }
  void hideLoading() {
    _loadingscreen.style.display = "none";
  }

  void showLoading() {
    _loadingscreen.style.display = "block";
  }

  void showGame() {
    _game.style.display = "block";
  }

  //updates the gameoverlay according to the gameend condition
  void updateOverlay(String s) {
    _gameend.innerHtml = s;
    _overlay.style.display = "block";
  }

  void hideOverlay() {
    _overlay.style.display = "none";
  }

  void hideNextLevel() {
    startNext.style.display = "none";
  }

  void showHighscore() {
    _highscore.style.visibility = "visible";
  }

  void showTop10(List<Map> scores, int score) {
    final list = scores
        .map((entry) => "<li>${entry['name']}: ${entry['score']}</li>")
        .join("");
    final points = "You got $score points";
    _overlay.innerHtml =
        "<div id='scorelist'> $points ${ list.isEmpty? "" : "<ol>$list</ol>"}</div>";
  }

  String get user =>
      (document.querySelector('#username') as InputElement).value;

  //see _labyrinthToHTMLTable
  void initTable(List<List<Types>> l) {
    String k = _createLabyrinth(l);
    _labyrinth.innerHtml = k;
  }

  //creates the table in the html-document
  String _createLabyrinth(List<List<Types>> l) {
    String labyrinthTable = "<table id=\"labyrinth\">";
    for (List<Types> row in l) {
      labyrinthTable += "<tr>";

      for (Types s in row) {
        labyrinthTable += "<td>" "</td>";
      }

      labyrinthTable += "</tr>";
    }
    return labyrinthTable += "</table>";
  }

  //loads the different game elements and their graphical representation into the table
  //distingush between screen/mobile(portrait) and mobile(landscape)
  void labyrinthFill(List<List<Types>> l) {
    var kl = _labyrinth.children[0].children[0];

    int _row = 0;
    int _col = 0;
    for (List<Types> row in l) {
      for (Types s in row) {
        if (_mql.matches && _mqlLandscape.matches) {
          switch (s) {
            case Types.WALL:
              kl.children[_row].children[_col].setAttribute("style", _wall16);
              break;
            case Types.DOOR:
              kl.children[_row].children[_col].setAttribute("style", _door16);
              break;
            case Types.BLINKY_RIGHT:
              kl.children[_row].children[_col]
                  .setAttribute("style", _blinky_r16);
              break;
            case Types.BLINKY_DOWN:
              kl.children[_row].children[_col]
                  .setAttribute("style", _blinky_d16);
              break;
            case Types.BLINKY_LEFT:
              kl.children[_row].children[_col]
                  .setAttribute("style", _blinky_l16);
              break;
            case Types.BLINKY_UP:
              kl.children[_row].children[_col]
                  .setAttribute("style", _blinky_u16);
              break;
            case Types.BLINKY_SCARE_RIGHT:
              kl.children[_row].children[_col]
                  .setAttribute("style", _scared_r16);
              break;
            case Types.BLINKY_SCARE_DOWN:
              kl.children[_row].children[_col]
                  .setAttribute("style", _scared_d16);
              break;
            case Types.BLINKY_SCARE_LEFT:
              kl.children[_row].children[_col]
                  .setAttribute("style", _scared_l16);
              break;
            case Types.BLINKY_SCARE_UP:
              kl.children[_row].children[_col]
                  .setAttribute("style", _scared_u16);
              break;
            case Types.PINKY_RIGHT:
              kl.children[_row].children[_col]
                  .setAttribute("style", _pinky_r16);
              break;
            case Types.PINKY_DOWN:
              kl.children[_row].children[_col]
                  .setAttribute("style", _pinky_d16);
              break;
            case Types.PINKY_LEFT:
              kl.children[_row].children[_col]
                  .setAttribute("style", _pinky_l16);
              break;
            case Types.PINKY_UP:
              kl.children[_row].children[_col]
                  .setAttribute("style", _pinky_u16);
              break;
            case Types.PINKY_SCARE_RIGHT:
              kl.children[_row].children[_col]
                  .setAttribute("style", _scared_r16);
              break;
            case Types.PINKY_SCARE_DOWN:
              kl.children[_row].children[_col]
                  .setAttribute("style", _scared_d16);
              break;
            case Types.PINKY_SCARE_LEFT:
              kl.children[_row].children[_col]
                  .setAttribute("style", _scared_l16);
              break;
            case Types.PINKY_SCARE_UP:
              kl.children[_row].children[_col]
                  .setAttribute("style", _scared_u16);
              break;
            case Types.INKY_RIGHT:
              kl.children[_row].children[_col].setAttribute("style", _inky_r16);
              break;
            case Types.INKY_DOWN:
              kl.children[_row].children[_col].setAttribute("style", _inky_d16);
              break;
            case Types.INKY_LEFT:
              kl.children[_row].children[_col].setAttribute("style", _inky_l16);
              break;
            case Types.INKY_UP:
              kl.children[_row].children[_col].setAttribute("style", _inky_u16);
              break;
            case Types.INKY_SCARE_RIGHT:
              kl.children[_row].children[_col]
                  .setAttribute("style", _scared_r16);
              break;
            case Types.INKY_SCARE_DOWN:
              kl.children[_row].children[_col]
                  .setAttribute("style", _scared_d16);
              break;
            case Types.INKY_SCARE_LEFT:
              kl.children[_row].children[_col]
                  .setAttribute("style", _scared_l16);
              break;
            case Types.INKY_SCARE_UP:
              kl.children[_row].children[_col]
                  .setAttribute("style", _scared_u16);
              break;
            case Types.CLYDE_RIGHT:
              kl.children[_row].children[_col]
                  .setAttribute("style", _clyde_r16);
              break;
            case Types.CLYDE_DOWN:
              kl.children[_row].children[_col]
                  .setAttribute("style", _clyde_d16);
              break;
            case Types.CLYDE_LEFT:
              kl.children[_row].children[_col]
                  .setAttribute("style", _clyde_l16);
              break;
            case Types.CLYDE_UP:
              kl.children[_row].children[_col]
                  .setAttribute("style", _clyde_u16);
              break;
            case Types.CLYDE_SCARE_RIGHT:
              kl.children[_row].children[_col]
                  .setAttribute("style", _scared_r16);
              break;
            case Types.CLYDE_SCARE_DOWN:
              kl.children[_row].children[_col]
                  .setAttribute("style", _scared_d16);
              break;
            case Types.CLYDE_SCARE_LEFT:
              kl.children[_row].children[_col]
                  .setAttribute("style", _scared_l16);
              break;
            case Types.CLYDE_SCARE_UP:
              kl.children[_row].children[_col]
                  .setAttribute("style", _scared_u16);
              break;
            case Types.PACMAN_RIGHT:
              kl.children[_row].children[_col]
                  .setAttribute("style", _pacman_r16);
              break;
            case Types.PACMAN_LEFT:
              kl.children[_row].children[_col]
                  .setAttribute("style", _pacman_l16);
              break;
            case Types.PACMAN_UP:
              kl.children[_row].children[_col]
                  .setAttribute("style", _pacman_u16);
              break;
            case Types.PACMAN_DOWN:
              kl.children[_row].children[_col]
                  .setAttribute("style", _pacman_d16);
              break;
            case Types.PILL:
              kl.children[_row].children[_col].setAttribute("style", _pill16);
              break;
            case Types.POWERPILL:
              kl.children[_row].children[_col]
                  .setAttribute("style", _powerpill16);
              break;
            case Types.CHERRY:
              kl.children[_row].children[_col].setAttribute("style", _cherry16);
              break;
            case Types.APPLE:
              kl.children[_row].children[_col].setAttribute("style", _apple16);
              break;
            case Types.NOTHING:
              kl.children[_row].children[_col].setAttribute("style", "");
              break;
            default:
              break;
          }
        } else {
          switch (s) {
            case Types.WALL:
              kl.children[_row].children[_col].setAttribute("style", _wall);
              break;
            case Types.DOOR:
              kl.children[_row].children[_col].setAttribute("style", _door);
              break;
            case Types.BLINKY_RIGHT:
              kl.children[_row].children[_col].setAttribute("style", _blinky_r);
              break;
            case Types.BLINKY_DOWN:
              kl.children[_row].children[_col].setAttribute("style", _blinky_d);
              break;
            case Types.BLINKY_LEFT:
              kl.children[_row].children[_col].setAttribute("style", _blinky_l);
              break;
            case Types.BLINKY_UP:
              kl.children[_row].children[_col].setAttribute("style", _blinky_u);
              break;
            case Types.BLINKY_SCARE_RIGHT:
              kl.children[_row].children[_col].setAttribute("style", _scared_r);
              break;
            case Types.BLINKY_SCARE_DOWN:
              kl.children[_row].children[_col].setAttribute("style", _scared_d);
              break;
            case Types.BLINKY_SCARE_LEFT:
              kl.children[_row].children[_col].setAttribute("style", _scared_l);
              break;
            case Types.BLINKY_SCARE_UP:
              kl.children[_row].children[_col].setAttribute("style", _scared_u);
              break;
            case Types.PINKY_RIGHT:
              kl.children[_row].children[_col].setAttribute("style", _pinky_r);
              break;
            case Types.PINKY_DOWN:
              kl.children[_row].children[_col].setAttribute("style", _pinky_d);
              break;
            case Types.PINKY_LEFT:
              kl.children[_row].children[_col].setAttribute("style", _pinky_l);
              break;
            case Types.PINKY_UP:
              kl.children[_row].children[_col].setAttribute("style", _pinky_u);
              break;
            case Types.PINKY_SCARE_RIGHT:
              kl.children[_row].children[_col].setAttribute("style", _scared_r);
              break;
            case Types.PINKY_SCARE_DOWN:
              kl.children[_row].children[_col].setAttribute("style", _scared_d);
              break;
            case Types.PINKY_SCARE_LEFT:
              kl.children[_row].children[_col].setAttribute("style", _scared_l);
              break;
            case Types.PINKY_SCARE_UP:
              kl.children[_row].children[_col].setAttribute("style", _scared_u);
              break;
            case Types.INKY_RIGHT:
              kl.children[_row].children[_col].setAttribute("style", _inky_r);
              break;
            case Types.INKY_DOWN:
              kl.children[_row].children[_col].setAttribute("style", _inky_d);
              break;
            case Types.INKY_LEFT:
              kl.children[_row].children[_col].setAttribute("style", _inky_l);
              break;
            case Types.INKY_UP:
              kl.children[_row].children[_col].setAttribute("style", _inky_u);
              break;
            case Types.INKY_SCARE_RIGHT:
              kl.children[_row].children[_col].setAttribute("style", _scared_r);
              break;
            case Types.INKY_SCARE_DOWN:
              kl.children[_row].children[_col].setAttribute("style", _scared_d);
              break;
            case Types.INKY_SCARE_LEFT:
              kl.children[_row].children[_col].setAttribute("style", _scared_l);
              break;
            case Types.INKY_SCARE_UP:
              kl.children[_row].children[_col].setAttribute("style", _scared_u);
              break;
            case Types.CLYDE_RIGHT:
              kl.children[_row].children[_col].setAttribute("style", _clyde_r);
              break;
            case Types.CLYDE_DOWN:
              kl.children[_row].children[_col].setAttribute("style", _clyde_d);
              break;
            case Types.CLYDE_LEFT:
              kl.children[_row].children[_col].setAttribute("style", _clyde_l);
              break;
            case Types.CLYDE_UP:
              kl.children[_row].children[_col].setAttribute("style", _clyde_u);
              break;
            case Types.CLYDE_SCARE_RIGHT:
              kl.children[_row].children[_col].setAttribute("style", _scared_r);
              break;
            case Types.CLYDE_SCARE_DOWN:
              kl.children[_row].children[_col].setAttribute("style", _scared_d);
              break;
            case Types.CLYDE_SCARE_LEFT:
              kl.children[_row].children[_col].setAttribute("style", _scared_l);
              break;
            case Types.CLYDE_SCARE_UP:
              kl.children[_row].children[_col].setAttribute("style", _scared_u);
              break;
            case Types.PACMAN_RIGHT:
              kl.children[_row].children[_col].setAttribute("style", _pacman_r);
              break;
            case Types.PACMAN_LEFT:
              kl.children[_row].children[_col].setAttribute("style", _pacman_l);
              break;
            case Types.PACMAN_UP:
              kl.children[_row].children[_col].setAttribute("style", _pacman_u);
              break;
            case Types.PACMAN_DOWN:
              kl.children[_row].children[_col].setAttribute("style", _pacman_d);
              break;
            case Types.PILL:
              kl.children[_row].children[_col].setAttribute("style", _pill);
              break;
            case Types.POWERPILL:
              kl.children[_row].children[_col]
                  .setAttribute("style", _powerpill);
              break;
            case Types.CHERRY:
              kl.children[_row].children[_col].setAttribute("style", _cherry);
              break;
            case Types.APPLE:
              kl.children[_row].children[_col].setAttribute("style", _apple);
              break;
            case Types.NOTHING:
              kl.children[_row].children[_col].setAttribute("style", "");
              break;
            default:
              break;
          }
        }
        _col++;
      }
      _col = 0;
      _row++;
    }
  }

  //displays the current level
  void updateLevel(int level) {
    _level.innerHtml = " $level";
  }

  void updateScore(int score) {
    _score.innerHtml = " $score";
  }

  //displays the current number of lives
  void updateLives(int lives) {
    _lives.innerHtml = " $lives";
  }

  void showMobile() {
    _mobile.style.display = "block";
  }

  void updateMessages(String str, bool f) {
    if (f) {
      _message.style.color = "yellow";
      _message.style.border = "5px solid yellow";
    } else {
      _message.style.color = "red";
      _message.style.border = "5px solid yellow";
    }
    _message.innerHtml = str;
  }
}
