part of pacmanLib;

/**
 * the paths as const for the different graphics
 */
/**
 * enviornment resources
 */
const String wall = "background-image:url(../web/resc/enviornment/wall32.png);";
const String door = "background-image:url(../web/resc/enviornment/door32.png);";
const String wall16 = "background-image:url(../web/resc/16px/enviornment/wall16.png);";
const String door16 = "background-image:url(../web/resc/16px/enviornment/door16.png);";
/**
 * ghost normal state resources
 */
/**
 * Blinky
 */
const String blinky_r = "background-image:url(../web/resc/ghosts/blinky/blinky_r32.png);";
const String blinky_l = "background-image:url(../web/resc/ghosts/blinky/blinky_l32.png);";
const String blinky_u = "background-image:url(../web/resc/ghosts/blinky/blinky_t32.png);";
const String blinky_d = "background-image:url(../web/resc/ghosts/blinky/blinky_d32.png);";
const String blinky_r16 = "background-image:url(../web/resc/16px/ghosts/blinky/blinky_r16.png);";
const String blinky_l16 = "background-image:url(../web/resc/16px/ghosts/blinky/blinky_l16.png);";
const String blinky_u16 = "background-image:url(../web/resc/16px/ghosts/blinky/blinky_t16.png);";
const String blinky_d16 = "background-image:url(../web/resc/16px/ghosts/blinky/blinky_d16.png);";
/**
 * Pinky
 */
const String pinky_r = "background-image:url(../web/resc/ghosts/pinky/pinky_r32.png);";
const String pinky_l = "background-image:url(../web/resc/ghosts/pinky/pinky_l32.png);";
const String pinky_u = "background-image:url(../web/resc/ghosts/pinky/pinky_t32.png);";
const String pinky_d = "background-image:url(../web/resc/ghosts/pinky/pinky_d32.png);";
const String pinky_r16 = "background-image:url(../web/resc/16px/ghosts/pinky/pinky_r16.png);";
const String pinky_l16 = "background-image:url(../web/resc/16px/ghosts/pinky/pinky_l16.png);";
const String pinky_u16 = "background-image:url(../web/resc/16px/ghosts/pinky/pinky_t16.png);";
const String pinky_d16  = "background-image:url(../web/resc/16px/ghosts/pinky/pinky_d16.png);";
/**
 * Inky
 */
const String inky_r = "background-image:url(../web/resc/ghosts/inky/inky_r32.png);";
const String inky_l = "background-image:url(../web/resc/ghosts/inky/inky_l32.png);";
const String inky_u = "background-image:url(../web/resc/ghosts/inky/inky_t32.png);";
const String inky_d = "background-image:url(../web/resc/ghosts/inky/inky_d32.png);";
const String inky_r16 = "background-image:url(../web/resc/16px/ghosts/inky/inky_r16.png);";
const String inky_l16 = "background-image:url(../web/resc/16px/ghosts/inky/inky_l16.png);";
const String inky_u16 = "background-image:url(../web/resc/16px/ghosts/inky/inky_t16.png);";
const String inky_d16 = "background-image:url(../web/resc/16px/ghosts/inky/inky_d16.png);";
/**
 * Clyde
 */
const String clyde_r = "background-image:url(../web/resc/ghosts/clyde/clyde_r32.png);";
const String clyde_l = "background-image:url(../web/resc/ghosts/clyde/clyde_l32.png);";
const String clyde_u = "background-image:url(../web/resc/ghosts/clyde/clyde_t32.png);";
const String clyde_d = "background-image:url(../web/resc/ghosts/clyde/clyde_d32.png);";
const String clyde_r16 = "background-image:url(../web/resc/16px/ghosts/clyde/clyde_r16.png);";
const String clyde_l16 = "background-image:url(../web/resc/16px/ghosts/clyde/clyde_l16.png);";
const String clyde_u16 = "background-image:url(../web/resc/16px/ghosts/clyde/clyde_t16.png);";
const String clyde_d16 = "background-image:url(../web/resc/16px/ghosts/clyde/clyde_d16.png);";
/**
 * ghost scared state resources
 */
const String scared_r = "background-image:url(../web/resc/ghosts/scared/a_scaredghost_r.gif);";
const String scared_l = "background-image:url(../web/resc/ghosts/scared/a_scaredghost_l.gif);";
const String scared_u = "background-image:url(../web/resc/ghosts/scared/a_scaredghost_t.gif);";
const String scared_d = "background-image:url(../web/resc/ghosts/scared/a_scaredghost_d.gif);";
const String scared_r16 = "background-image:url(../web/resc/16px/ghosts/scared/a_scaredghost_r16.gif);";
const String scared_l16 = "background-image:url(../web/resc/16px/ghosts/scared/a_scaredghost_l16.gif);";
const String scared_u16 = "background-image:url(../web/resc/16px/ghosts/scared/a_scaredghost_t16.gif);";
const String scared_d16 = "background-image:url(../web/resc/16px/ghosts/scared/a_scaredghost_d16.gif);";
/**
 * Pacman normal state resources
 */
const String pacman_r = "background-image:url(../web/resc/pacman/pacman_r32.gif);";
const String pacman_l = "background-image:url(../web/resc/pacman/pacman_l32.gif);";
const String pacman_u = "background-image:url(../web/resc/pacman/pacman_u32.gif);";
const String pacman_d = "background-image:url(../web/resc/pacman/pacman_d32.gif);";
const String pacman_r16 = "background-image:url(../web/resc/16px/pacman/pacman_r16.gif);";
const String pacman_l16 = "background-image:url(../web/resc/16px/pacman/pacman_l16.gif);";
const String pacman_u16 = "background-image:url(../web/resc/16px/pacman/pacman_u16.gif);";
const String pacman_d16 = "background-image:url(../web/resc/16px/pacman/pacman_d16.gif);";
/**
 * pacman powerpill state resources
 */
const String p_pacman_r = "background-image:url(../web/resc/pacman/power_pacman_r32.gif);";
const String p_pacman_l = "background-image:url(../web/resc/pacman/power_pacman_l32.gif);";
const String p_pacman_u = "background-image:url(../web/resc/pacman/power_pacman_u32.gif);";
const String p_pacman_d = "background-image:url(../web/resc/pacman/power_pacman_d32.gif);";
const String p_pacman_r16 = "background-image:url(../web/resc/16px/pacman/power_pacman_r16.gif);";
const String p_pacman_l16 = "background-image:url(../web/resc/16px/pacman/power_pacman_l16.gif);";
const String p_pacman_u16 = "background-image:url(../web/resc/16px/pacman/power_pacman_u16.gif);";
const String p_pacman_d16 = "background-image:url(../web/resc/16px/pacman/power_pacman_d16.gif);";
/**
 * items resources
 */
const String pill = "background-image:url(../web/resc/items/pill32.png);";
const String powerpill = "background-image:url(../web/resc/items/a_powerpill32.gif);";
const String cherry = "background-image:url(../web/resc/items/a_cherry32.gif);";
const String pill16 = "background-image:url(../web/resc/16px/items/pill16.png);";
const String powerpill16 = "background-image:url(../web/resc/16px/items/a_powerpill16.gif);";
const String cherry16 = "background-image:url(../web/resc/16px/items/a_cherry16.gif);";


/**
 * A [PacmanGameView] object interacts with the DOM tree
 * to reflect actual [PacmanGame] state to the user
 */
class PacmanGameView {

  PacmanGameController _con;

  //the different div-classes from the html-document
  final _startScreen = querySelector(".start");
  final _message = querySelector(".messages");
  final _game = querySelector(".game");

  //different elements from the html-document
  final _startText = querySelector("#startText");
  final startButton = querySelector("#startButton");
  final startNext = querySelector("#startNext");
  final _overlay = querySelector("#overlay");
  final _gameend = querySelector("#gameend");
  final nextLevel = querySelector("#startNext");
  final _labyrinth = querySelector("#labyrinth");

  final _information = querySelector("#information");
  final _level = querySelector("#value1");
  final _score = querySelector("#value2");
  final _lives = querySelector("#value3");

  //mobile keys
  final mobile = querySelector(".mobile");
  final mobileUp = querySelector("#mobileUp");
  final mobileDown = querySelector("#mobileDown");
  final mobileLeft = querySelector("#mobileLeft");
  final mobileRight = querySelector("#mobileRight");

  var mql = window.matchMedia("screen and (max-device-width : 800px)");
  var mql2 = window.matchMedia("screen and (orientation: landscape)");
  //constructor
  PacmanGameView(_con);

  //close start screen and show the gamefield
  void showGameview() {
    _startScreen.classes.toggle('close');
    _game.classes.toggle('show');
  }

  //TODO: NextLevel
  void showNextLevel() {
   _overlay.classes.toggle('hide');
  }
  void updateGameStatus() {}

  //see _labyrinthToHTMLTable
  void initTable(List<List<Types>> l) {
    _labyrinth.innerHtml = _createLabyrinth(l);
  }
  //displays the current score
  void updateScore(int score) {
    _score.innerHtml = " $score";
  }
  void updateLevel(int level){
    _level.innerHtml = " $level";
  }
  void updateLives(int lives){
    _lives.innerHtml = " $lives";
  }
  void updateMessages(String str) {
    _message.innerHtml = "Msg: $str"; }

  void updateOverlay(String s) {
    _gameend.innerHtml = s;
    _overlay.classes.toggle('show');
  }
  //creates the table in the html-document
  String _createLabyrinth(List<List<Types>> l) {

    String labyrinthTable = "<table>";
    for (List<Types> row in l) {
      labyrinthTable += "<tr>";

      for (Types s in row) {
        labyrinthTable += "<td>""</td>";
        }

      labyrinthTable += "</tr>";
    }
    return labyrinthTable += "</table>";
  }

  //loads the different game elements and their graphical representation into the table
  void _labyrinthFill(List<List<Types>> l) {

    var kl = _labyrinth.children[0].children[0];

    int _row = 0;
    int _col = 0;
    for (List<Types> row in l) {

      for (Types s in row) {
        if (mql.matches && mql2.matches) {
          switch (s) {
            case Types.WALL :
              kl.children[_row].children[_col].setAttribute("style", wall16);
              break;
            case Types.DOOR :
              kl.children[_row].children[_col].setAttribute("style", door16);
              break;
            case Types.BLINKY :
              kl.children[_row].children[_col].setAttribute("style", blinky_r16);
              break;
            case Types.BLINKY_EATABLE :
              kl.children[_row].children[_col].setAttribute("style", scared_r16);
              break;
            case Types.PINKY :
              kl.children[_row].children[_col].setAttribute("style", pinky_r16);
              break;
            case Types.PINKY_EATABLE :
              kl.children[_row].children[_col].setAttribute("style", scared_r16);
              break;
            case Types.INKY :
              kl.children[_row].children[_col].setAttribute("style", inky_r16);
              break;
            case Types.INKY_EATABLE :
              kl.children[_row].children[_col].setAttribute("style", scared_r16);
              break;
            case Types.CLYDE :
              kl.children[_row].children[_col].setAttribute("style", clyde_r16);
              break;
            case Types.CLYDE_EATABLE :
              kl.children[_row].children[_col].setAttribute("style", scared_r16);
              break;
            case Types.PACMAN_RIGHT :
              kl.children[_row].children[_col].setAttribute("style", pacman_r16);
              break;
            case Types.PACMAN_LEFT :
              kl.children[_row].children[_col].setAttribute("style", pacman_l16);
              break;
            case Types.PACMAN_UP :
              kl.children[_row].children[_col].setAttribute("style", pacman_u16);
              break;
            case Types.PACMAN_DOWN :
              kl.children[_row].children[_col].setAttribute("style", pacman_d16);
              break;
            case Types.PILL :
              kl.children[_row].children[_col].setAttribute("style", pill16);
              break;
            case Types.POWERPILL :
              kl.children[_row].children[_col].setAttribute("style", powerpill16);
              break;
            case Types.CHERRY :
              kl.children[_row].children[_col].setAttribute("style", cherry16);
              break;
            case Types.NOTHING :
              kl.children[_row].children[_col].setAttribute("style", "");
              break;
            default:
              break;
          }

        }else {
          switch (s) {
            case Types.WALL :
              kl.children[_row].children[_col].setAttribute("style", wall);
              break;
            case Types.DOOR :
              kl.children[_row].children[_col].setAttribute("style", door);
              break;
            case Types.BLINKY :
              kl.children[_row].children[_col].setAttribute("style", blinky_r);
              break;
            case Types.BLINKY_EATABLE :
              kl.children[_row].children[_col].setAttribute("style", scared_r);
              break;
            case Types.PINKY :
              kl.children[_row].children[_col].setAttribute("style", pinky_r);
              break;
            case Types.PINKY_EATABLE :
              kl.children[_row].children[_col].setAttribute("style", scared_r);
              break;
            case Types.INKY :
              kl.children[_row].children[_col].setAttribute("style", inky_r);
              break;
            case Types.INKY_EATABLE:
              kl.children[_row].children[_col].setAttribute("style", scared_r);
              break;
            case Types.CLYDE :
              kl.children[_row].children[_col].setAttribute("style", clyde_r);
              break;
            case Types.CLYDE_EATABLE :
              kl.children[_row].children[_col].setAttribute("style", scared_r);
              break;
            case Types.PACMAN_RIGHT :
              kl.children[_row].children[_col].setAttribute("style", pacman_r);
              break;
            case Types.PACMAN_LEFT :
              kl.children[_row].children[_col].setAttribute("style", pacman_l);
              break;
            case Types.PACMAN_UP :
              kl.children[_row].children[_col].setAttribute("style", pacman_u);
              break;
            case Types.PACMAN_DOWN :
              kl.children[_row].children[_col].setAttribute("style", pacman_d);
              break;
            case Types.PILL :
              kl.children[_row].children[_col].setAttribute("style", pill);
              break;
            case Types.POWERPILL :
              kl.children[_row].children[_col].setAttribute("style", powerpill);
              break;
            case Types.CHERRY :
              kl.children[_row].children[_col].setAttribute("style", cherry);
              break;
            case Types.NOTHING :
              kl.children[_row].children[_col].setAttribute("style", "");
              break;
            default:
              break;
          }
        }
        _col++;
      }
      _col = 0;
      _row++;
    }
  }

}
